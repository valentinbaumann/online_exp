<!DOCTYPE html>

<html lang="de">

<head>

  <meta charset="UTF-8"/>
  
  <!-- name of experiment -->
  <title>offline_test_Day1</title>  
  
  <!-- loads jspsych plugins (offline) -->
  <script type="text/javascript" src="jspsych-6.0.5/jspsych.js"></script>
  <link rel="stylesheet" type="text/css" href="jspsych-6.0.5/css/jspsych.css"/>
  <script type="text/javascript" src="jspsych-6.0.5/plugins/jspsych-html-keyboard-response.js"></script>
  <script type="text/javascript" src="jspsych-6.0.5/plugins/jspsych-image-keyboard-response.js"></script>
	<script type="text/javascript" src="jspsych-6.0.5/plugins/jspsych-html-button-response.js"></script>
	<script type="text/javascript" src="jspsych-6.0.5/plugins/jspsych-html-keyboard-response.js"></script>
	<script type="text/javascript" src="jspsych-6.0.5/plugins/jspsych-fullscreen.js"></script>
  <script src="jspsych-6.0.5/plugins/jspsych-survey-text.js"></script> 

</head>



<!-- this is the Javascript section -->
<script>
  


	///////////////////////////////////////////////////////
	// define variables

	// create timeline
	var timeline = [];

	var console_test = "go console!";
	console.log(console_test);
  
	// create condition variable
	var condition_array = ["STM", "noSTM", "LOP"]
	condition_array = jsPsych.randomization.shuffle(condition_array)    // shuffle array
	var condition = condition_array[0]      // get first element
	jsPsych.data.addProperties({condition: condition});	// adds condition variable to all trials in the data
	console.log("condition: " + condition);

	// complete learning list (should be an even number of words!)
	var words_learning= [
		{word: 'Muffin (alt)', data: {trial_code: 'learning', word_validity: 'old', block: 99, orienting: "none"}},
		{word: 'Keks (alt)', data: {trial_code: 'learning', word_validity: 'old', block: 99, orienting: "none"}},
		{word: 'Torte (alt)', data: {trial_code: 'learning', word_validity: 'old', block: 99, orienting: "none"}},
		{word: 'Kuchen (alt)', data: {trial_code: 'learning', word_validity: 'old', block: 99, orienting: "none"}},
	];

	// shuffle learning list
	words_learning = jsPsych.randomization.shuffle(words_learning) ;

	// if condition == LOP, prepare learning list for LOP learning
	if (condition == "LOP"){
		// divide learning list into blocks 
		var words_learning_block1 = words_learning.slice(0, words_learning.length / 2);		// take 1st half of learning list for Block 1
		var words_learning_block2 = words_learning.slice(words_learning.length / 2, words_learning.length); 	// take 2nd half of learning list for Block 2

		// get a random order of orienting tasks
		var orienting_task = ["adjective", "rhyme"];
		orienting_task = jsPsych.randomization.shuffle(orienting_task) ;
		console.log("Block1: " + orienting_task[0]);
		console.log("Block2: " + orienting_task[1]);

		// update learning list for the different blocks with block number and orienting task type (somehow, this also updates the original learning list???)
		var i																																		// counting variable needs to be defined out of the loop
		for (i = 0; i < words_learning_block1.length; i = i + 1){
			words_learning_block1[i]["data"]["orienting"] = orienting_task[0];		// can also be written as ...block1[1].data.orienting
			words_learning_block1[i]["data"]["block"] = 1;
		};
		var j 
		for (j = 0; j < words_learning_block2.length; j = j + 1){
			words_learning_block2[j]["data"]["orienting"] = orienting_task[1];
			words_learning_block2[j]["data"]["block"] = 2;
		};
	} 



	///////////////////////////////////////////////////////
	// prepare trials within secondary timelines

	// recognition list 
	var words_recognition= [
		{word: 'Muffin (alt)', data: {trial_code: 'recognition', word_validity: 'old'}},
		{word: 'Keks (alt)', data: {trial_code: 'recognition', word_validity: 'old'}},
		{word: 'Waffel (neu)', data: {trial_code: 'recognition', word_validity: 'new'}},
		{word: 'Macaron (neu)', data: {trial_code: 'recognition', word_validity: 'new'}},
	];
	
	// create fixation trial
	var fixation_trial = {
		type: 'html-keyboard-response',
    stimulus: '<div style="font-size:60px;">+</div>',
    choices: jsPsych.NO_KEYS,
		trial_duration: 500,
		post_trial_gap: 0,
		data: {trial_code: 'fixation'}
    }

	// create learning trial	
  var learning_trial = {
        type: 'html-keyboard-response',
				stimulus: jsPsych.timelineVariable('word'),
        choices: jsPsych.NO_KEYS,
				trial_duration: 500,
        post_trial_gap: 0,
				data: jsPsych.timelineVariable('data'),
	};			



	///////////////////////////////////////////////////////
	// define the final trials

	var fullscreen_trial = {
		type: 'fullscreen',
		message: '',
		button_label: ['Start and enter fullscreen mode'],
		fullscreen_mode: true,
	}
	timeline.push(fullscreen_trial);

	// welcome instruction
	var welcome_instruction_trial = {
		type: 'html-button-response',
    stimulus: '<p> Willkommen! <br> <br> Ankas & Lindas coole Masterarbeit </p>',
		choices: ['Los!']
	};
	timeline.push(welcome_instruction_trial);

 	// subject ID
	var subject_id_trial = {
		type: 'survey-text',
		questions: [{prompt: "Bitte gib deinen persönlichen Probandencode ein:"}],
	};
	timeline.push(subject_id_trial); 
 
	// biographic data
	var survey_trial = {
		type: 'survey-text',
		questions: [{prompt: "höchster Bildungsabschluss:"}, {prompt: "Wie alt bist du?"}, {prompt: "Geschlecht?"}],
	};
	timeline.push(survey_trial); 

	// choose type of learning instruction and learning task dependent on condition
	if (condition == "STM"){

			var learning_instruction_trial = {							// learning instruction for STM
				type: 'html-button-response',
				stimulus: '<p> Aufgabe: Lernen </p>' + '<p> Die werden nacheinander einige Wörter gezeigt. Versuche dir alle so gut wie möglich zu merken, du wirst gleich danach abgefragt werden! </p>',
				choices: ['Los!']
			};
			timeline.push(learning_instruction_trial);

			var learning_timeline = {												// learning task with own internal timeline (learning trial + fixation, defined above)
				timeline_variables: words_learning,
				randomize_order: true,
				timeline: [fixation_trial, learning_trial]	
			}	
			timeline.push(learning_timeline)

	} else if (condition == "noSTM"){

			var learning_instruction_trial = {							// learning instruction for noSTM
				type: 'html-button-response',
				stimulus: '<p> Aufgabe: Lernen </p>' + '<p> Die werden nacheinander einige Wörter gezeigt. Versuche dir alle so gut wie möglich zu merken! </p>',
				choices: ['Los!']
			};
			timeline.push(learning_instruction_trial);

			var learning_timeline = {												// learning task with own internal timeline (learning trial + fixation, defined above)
				timeline_variables: words_learning,
				randomize_order: true,
				timeline: [fixation_trial, learning_trial]	
			}	
			timeline.push(learning_timeline)

	} else if (condition == "LOP"){
		
			if (words_learning_block1[0]["data"]["orienting"] == "rhyme"){

						var learning_instruction_trial = {							// learning instruction for "rhyme"
							type: 'html-button-response',
							stimulus: '<p> Aufgabe: Lernen </p>' + '<p> Die werden nacheinander einige Wörter gezeigt. Bilde einen Reim für jedes Wort (z.B.  Haus - Maus)! </p>',
							choices: ['Los!']
						};
						timeline.push(learning_instruction_trial);
						
						var learning_timeline = {												// learning task for "rhyme"
							timeline_variables: words_learning_block1,
							randomize_order: true,
							timeline: [fixation_trial, learning_trial]	
						}	
						timeline.push(learning_timeline)

						var learning_instruction_trial = {							// learning instruction for "adjective"
							type: 'html-button-response',
							stimulus: '<p> Aufgabe: Lernen </p>' + '<p> Die werden nacheinander einige Wörter gezeigt. Bilde einen Adjektiv für jedes Wort (z.B.  Haus - groß)! </p>',
							choices: ['Los!']
						};
						timeline.push(learning_instruction_trial);		
						
						var learning_timeline = {												// learning task for "adjective"
							timeline_variables: words_learning_block2,
							randomize_order: true,
							timeline: [fixation_trial, learning_trial]	
						}	
						timeline.push(learning_timeline)

			} else {

						var learning_instruction_trial = {							// learning instruction for "adjective"
							type: 'html-button-response',
							stimulus: '<p> Aufgabe: Lernen </p>' + '<p> Die werden nacheinander einige Wörter gezeigt. Bilde ein Adjektiv für jedes Wort (z.B.  Haus - groß)! </p>',
							choices: ['Los!']
						};
						timeline.push(learning_instruction_trial);
						
						var learning_timeline = {												// learning task for "adjective"
							timeline_variables: words_learning_block1,
							randomize_order: true,
							timeline: [fixation_trial, learning_trial]	
						}	
						timeline.push(learning_timeline)

						var learning_instruction_trial = {							// learning instruction for "rhyme"
							type: 'html-button-response',
							stimulus: '<p> Aufgabe: Lernen </p>' + '<p> Die werden nacheinander einige Wörter gezeigt. Bilde einen Reim für jedes Wort (z.B.  Haus - Maus)! </p>',
							choices: ['Los!']
						};
						timeline.push(learning_instruction_trial);		
						
						var learning_timeline = {												// learning task for "rhyme"
							timeline_variables: words_learning_block2,
							randomize_order: true,
							timeline: [fixation_trial, learning_trial]	
						}	
						timeline.push(learning_timeline)
			}

	}

	// add a STM recall, if condition == STM
	if (condition == "STM"){

			var recall_instruction_trial = {				//  recall instruction
				type: 'html-button-response',
				stimulus: '<p> Aufgabe: Erinnern </p>' + '<p> </p>',
				choices: ['Los!']
			};
			timeline.push(recall_instruction_trial);

			var recall_trial = {										// recall task
				type: 'survey-text',
				questions: [{prompt: "Bitte schreibe alle Wörter auf, an die du dich noch erinnern kannst.", rows: 20, columns: 40}],
			};
			timeline.push(recall_trial); 
	}

	// end trial
	var end_trial = {
		type: 'html-button-response',
		stimulus: '<p>Ende</p>',
		choices: ['Ende!']
	};
	timeline.push(end_trial);
   


		
	///////////////////////////////////////////////////////
	// start experiment

	// starts playing the timeline
	jsPsych.init({
		timeline: timeline,
		on_finish: function() {jsPsych.data.displayData('csv');},					// displays data at the end
	});

  
</script>

</html>